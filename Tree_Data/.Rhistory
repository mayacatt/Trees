SLL.tot.sp.abund <- left_join(tot.abund.site, SLL.abund.site)
SLL.tot.sp.abund[is.na(SLL.tot.sp.abund)]<-0
View(SLL.tot.sp.abund)
SLL.tot.sp.abund$Proportions <- SLL.tot.sp.abund$ABUNDANCE_NAT/SLL.tot.sp.abund$ABUNDANCE_TOT
SLL.tot.sp.abund$Region <- recode(SLL.tot.sp.abund$Region, "SLL" =0)
SLL.tot.sp.abund$Region <- recode(SLL.tot.sp.abund$Region, "SLL" ='0')
SLL.tot.sp.abund$Region <- recode(SLL.tot.sp.abund$Region, 0='SLL')
SLL.tot.sp.abund$Region <- recode(SLL.tot.sp.abund$Region, 0="SLL")
SLL.tot.sp.abund$Region <- recode(SLL.tot.sp.abund$Region, '0'="SLL")
SLL.tot.sp.abund <- left_join(tot.abund.site, SLL.abund.site)
SLL.tot.sp.abund[is.na(SLL.tot.sp.abund)]<-0
SLL.tot.sp.abund$Proportions <- SLL.tot.sp.abund$ABUNDANCE_NAT/SLL.tot.sp.abund$ABUNDANCE_TOT
SLL.tot.sp.abund$Region <- recode(SLL.tot.sp.abund$Region, '0'="SLL")
SLL.tot.sp.abund[is.na(SLL.tot.sp.abund)]<-'0'
View(SLL.tot.sp.abund)
SLL.tot.sp.abund$Proportions <- SLL.tot.sp.abund$ABUNDANCE_NAT/SLL.tot.sp.abund$ABUNDANCE_TOT
SLL.tot.sp.abund$Region <- recode(SLL.tot.sp.abund$Region, '0'="SLL")
SLL.tot.sp.abund$Region <- dplyr::recode(SLL.tot.sp.abund$Region, '0'="SLL")
describe(SLL.tot.sp.abund$Proportions)
SLL.tot.sp.abund
ETF.tot.sp.abund <- left_join(tot.abund.site, ETF.abund.site)
ETF.tot.sp.abund[is.na(ETF.tot.sp.abund)]<-0
ETF.tot.sp.abund$Region
ETF.tot.sp.abund$Proportions <- ETF.tot.sp.abund$ABUNDANCE_NAT/ETF.tot.sp.abund$ABUNDANCE_TOT
ETF.tot.sp.abund$Region <- dplyr::recode(ETF.tot.sp.abund$Region, '0'="ETF")
ETF.tot.sp.abund
describe(ETF.tot.sp.abund$Proportions)
str(ETF.tot.sp.abund)
View(prop.tot)
#proportions per site (SLL & ETF)
prop.tot <- rbind(ETF.tot.sp.abund, SLL.tot.sp.abund)
write.csv(prop.tot, "output/prop.abund.tot.csv")
SLL.proportions <- left_join(Trees.per.site, SLL.Species)
SLL.proportions[is.na(SLL.proportions)] <- 0
View(Native.proportions)
str(Native.proportions)
SLL.proportions$Proportion <- SLL.proportions$SLL.per.site/SLL.proportions$total.per.site
ETF.proportions <- left_join(Trees.per.site, ETF.Species)
ETF.proportions[is.na(ETF.proportions)] <-0
ETF.proportions$Proportion <- ETF.proportions$ETF.per.site/ETF.proportions$total.per.site
Dawson.proportions <- merge(SLL.proportions, ETF.proportions, all=TRUE)
View(Dawson.proportions)
library(car)
str(Dawson.proportions)
ETF.tot.sp.abund
describe(ETF.tot.sp.abund$Proportions)
#proportions per site (SLL & ETF)
prop.tot <- rbind(ETF.tot.sp.abund, SLL.tot.sp.abund)
View(prop.tot)
#summary stats
meta <- read.csv("output/Dawson.Trees.With.Origin.csv")
#View(meta)
meta <- meta[,c(2:9, 10, 13:14)]
Sites <- meta[, c(1:4)]
View(Sites)
Sites <- distinct(Sites)
Site.Rich <- read.csv("output/prop.rich.tot.csv")
str(Site.Rich)
Site.Rich <- dplyr::rename(Site.Rich, "Proportion_RICH"= Proportion)
Site.Rich <- dplyr::rename(Site.Rich, "Site.Code"=X)
Site.Rich <- subset(Site.Rich, select = -c(X.1))
Site.Rich[order(Site.Rich[,'Site.Code']), ]
Meta.Rich <- dplyr::left_join(Sites, Site.Rich)
ETF.Rich <- subset(Site.Rich, Region=="ETF")
sum(ETF.Rich$RICHNESS_NAT)
Dawson.ETF.Rich <- subset(ETF.Rich, Site.Code=="I1")
sum(Dawson.ETF.Rich$RICHNESS_NAT)
SLL.Rich <- subset(Site.Rich, Region=="SLL")
sum(SLL.Rich$RICHNESS_NAT)
Dawson.SLL.Rich <- subset(SLL.Rich, Site.Code=="I1")
sum(Dawson.SLL.Rich$RICHNESS_NAT)
Sites.Abund <- read.csv("output/prop.abund.tot.csv")
str(Sites.Abund)
Sites.Abund <- dplyr::rename(Sites.Abund, "Proportion_ABUND"= Proportions)
Sites.Abund <- dplyr::rename(Sites.Abund, "Site.Code"=X)
Sites.Abund <- subset(Sites.Abund, select = -c(X.1))
str(Site.Rich)
Meta.Abund <- dplyr::left_join(Sites, Sites.Abund)
View(Meta.Abund)
ETF.Abund <- subset(Sites.Abund, Region=="ETF")
str(ETF.Abund)
sum(ETF.Abund$ABUNDANCE_NAT)
Dawson.ETF.Abund <- subset(ETF.Abund, Site.Code=="I1")
sum(Dawson.ETF.Abund$ABUNDANCE_NAT)
SLL.Abund <- subset(Sites.Abund, Region=="SLL")
SLL.Abund
Dawson.SLL.Abund <- subset(SLL.Abund, Site.Code=="I1")
sum(Dawson.SLL.Abund$ABUNDANCE_NAT)
134/261
138/261
Meta.Final <- merge(Meta.Abund, Meta.Rich)
View(Meta.Final)
write.csv(Meta.Final, "output/meta.analysis.csv")
#View(Meta.Rich)
head(Meta.Rich)
str(Meta.Rich)
#richness model
glm.richness <- glm(Proportion_RICH~Site.Type*Region, data=Meta.Rich)
glm.richness
glm.b.richness <- glm(Proportion_RICH~Site.Type+Region, family=binomial, data=Meta.Rich, weights = RICHNESS)
summary(glm.b.richness)
Anova(glm.b.richness)
print(anova(glm.b.richness))
hist(Meta.Rich$Proportion)
##Assumptions
plot(glm.b.richness)
#normality
shapiro.test(resid(glm.b.richness))
qqnorm(residuals(glm.b.richness))
qqline(residuals(glm.b.richness))
#homogeneity
bptest(glm.b.richness)
#pairwise comparisons
lsmeans(glm.b.richness, pairwise ~ Site.Type | Region , adjust="Tukey")
#abundance model
glm.abundance <- glm(Proportion_ABUND~Site.Type*Region, data=Meta.Abund)
glm.abundance
glm.b.abundance <- glm(Proportion_ABUND~Site.Type+Region, family=binomial, data=Meta.Abund, weights = ABUNDANCE_TOT)
summary(glm.b.abundance)
Anova(glm.b.abundance)
print(anova(glm.b.abundance))
hist(Meta.Abund$Proportion_ABUND)
##Assumptions
plot(glm.b.abundance)
#homogeneity
bptest(glm.b.abundance)
#pairwise comparisons
lsmeans(glm.b.abundance, pairwise ~ Site.Type | Region , adjust="Tukey")
#abundance model
glm.abundance <- glm(Proportion_ABUND~Site.Type|Region, data=Meta.Abund)
#abundance model
glm.abundance <- glm(Proportion_ABUND~Site.Type*Region, data=Meta.Abund)
glm.abundance
Anova(glm.abundance)
glm.b.abundance <- glm(Proportion_ABUND~Site.Type+Region, family=binomial, data=Meta.Abund, weights = ABUNDANCE_TOT)
summary(glm.b.abundance)
Anova(glm.b.abundance)
glm.b.abundance <- glm(Proportion_ABUND~Site.Type+*Region, family=binomial, data=Meta.Abund, weights = ABUNDANCE_TOT)
glm.b.abundance <- glm(Proportion_ABUND~Site.Type*Region, family=binomial, data=Meta.Abund, weights = ABUNDANCE_TOT)
summary(glm.b.abundance)
Anova(glm.b.abundance)
hist(Meta.Abund$Proportion_ABUND)
#pairwise comparisons
lsmeans(glm.b.abundance, pairwise ~ Site.Type | Region , adjust="Tukey")
?|
#pairwise comparisons
lsmeans(glm.b.abundance, pairwise ~ Site.Type + Region , adjust="Tukey")
#pairwise comparisons
lsmeans(glm.b.abundance, pairwise ~ Site.Type | Region , adjust="Tukey")
lsmeans(glm.b.abundance, pairwise~ Region | Site.Type, adjust="Tukey")
Anova(glm.b.abundance)
summary(glm.b.abundance)
Anova(glm.b.abundance)
print(anova(glm.b.abundance))
print(Anova(glm.b.abundance))
#abundance model
glm.abundance <- aovProportion_ABUND~Site.Type*Region, data=Meta.Abund)
#abundance model
aov.abundance <- aov(Proportion_ABUND~Site.Type*Region, data=Meta.Abund)
aov.abundance
anova(aov.abundance)
plot(aov.abundance)
shapiro.test(aov.abundance)
shapiro.test(resid(aov.abundance))
leveneTest(aov.abundance$residuals)
leveneTest(Proportion_ABUND~Site.Type*Region, data=Meta.Abund)
View(Dawson.SLL.Abund)
ETF.Rich <- subset(Site.Rich, Region=="ETF")
sum(ETF.Rich$RICHNESS_NAT)
Dawson.ETF.Rich <- subset(ETF.Rich, Site.Code=="I1")
sum(Dawson.ETF.Rich$RICHNESS_NAT)
SLL.Rich <- subset(Site.Rich, Region=="SLL")
sum(SLL.Rich$RICHNESS_NAT)
Dawson.ETF.Rich <- subset(ETF.Rich, Site.Code=="I1")
sum(Dawson.ETF.Rich$RICHNESS_NAT)
Dawson.ETF.Rich <- subset(ETF.Rich, Site.Code=="I1")
View(Dawson.ETF.Rich)
Site.Rich <- read.csv("output/prop.rich.tot.csv")
str(Site.Rich)
Site.Rich <- dplyr::rename(Site.Rich, "Proportion_RICH"= Proportion)
Site.Rich <- dplyr::rename(Site.Rich, "Site.Code"=X)
Site.Rich <- subset(Site.Rich, select = -c(X.1))
Site.Rich[order(Site.Rich[,'Site.Code']), ]
Meta.Rich <- dplyr::left_join(Sites, Site.Rich)
ETF.Rich <- subset(Site.Rich, Region=="ETF")
sum(ETF.Rich$RICHNESS_NAT)
Dawson.ETF.Rich <- subset(ETF.Rich, Site.Code=="I1")
Dawson.ETF.Rich
Meta.Rich <- dplyr::left_join(Sites, Site.Rich)
ETF.Rich <- subset(Site.Rich, Region=="ETF")
sum(ETF.Rich$RICHNESS_NAT)
Site.Rich <- read.csv("output/prop.rich.tot.csv")
str(Site.Rich)
Site.Rich <- dplyr::rename(Site.Rich, "Proportion_RICH"= Proportion)
Site.Rich <- dplyr::rename(Site.Rich, "Site.Code"=X)
Site.Rich <- subset(Site.Rich, select = -c(X.1))
str(Site.Rich)
Site.Rich <- read.csv("output/prop.rich.tot.csv")
str(Site.Rich)
#proportions per site (SLL & ETF)
prop.tot <- rbind(ETF.tot.sp.abund, SLL.tot.sp.abund)
View(prop.tot)
total.species <- read.csv("output/Dawson.Trees.With.Origin.csv")
str(total.species)
library(tidyr)
library(tidyverse)
library(plyr)
library(dplyr)
library(psych)
#total species richness/greenspacetype
tot.sp.table <- read.csv("output/total.sp.mat.csv")
pr.total<-ddply(tot.sp.table, ~X, function(x) {
data.frame(RICHNESS= sum((x[-1]>0)))})
names(pr.total)[names(pr.total)=='X'] <- 'GS.Type'
pr.total
#SLL sp richness/green space type
SLL.sp.matrix<- read.csv("output/SLL.sp.mat.csv")
str(SLL.sp.matrix)
View(SLL.sp.matrix)
SLL.per.total<-ddply(SLL.sp.matrix, ~X, function(x) {
data.frame(RICHNESS_NAT= sum((x[-1]>0)))
})
SLL.per.total
names(SLL.per.total)[names(SLL.per.total)=='X'] <- 'GS.Type'
describe(SLL.per.total$RICHNESS_NAT)
#ETF sp richness/green space type
ETF.sp.matrix<- read.csv("output/ETF.sp.mat.csv")
str(ETF.sp.matrix)
ETF.per.total<-ddply(ETF.sp.matrix, ~X, function(x) {
data.frame(RICHNESS_NAT= sum((x[-1]>0)))
})
names(ETF.per.total)[names(ETF.per.total)=='X'] <- 'GS.Type'
describe(ETF.per.total$RICHNESS_NAT)
#SLL PROP/GREEN SPACE
SLL.rich.prop <- left_join(pr.total, SLL.per.total)
SLL.rich.prop[is.na(SLL.rich.prop)] <-0
View(SLL.rich.prop)
SLL.rich.prop$Proportion <- SLL.rich.prop$RICHNESS_NAT/SLL.rich.prop$RICHNESS
SLL.rich.prop$Region <- "SLL"
str(SLL.rich.prop)
SLL.rich.prop
#ETF PROP/GREENSPACE
ETF.rich.prop <- left_join(pr.total, ETF.per.total)
ETF.rich.prop[is.na(ETF.rich.prop)] <-0
ETF.rich.prop$Proportion <- ETF.rich.prop$RICHNESS_NAT/ETF.rich.prop$RICHNESS
ETF.rich.prop$Region <- "ETF"
str(ETF.rich.prop)
#JOIN ETF AND SLL
prop.rich.tot <- rbind(ETF.rich.prop, SLL.rich.prop)
View(prop.rich.tot)
prop.rich.tot <- prop.rich.tot %>%
distinct()
prop.rich.tot$Region <- recode(prop.rich.tot$Region, "0"="NON-NAT")
View(prop.rich.tot)
write.csv(prop.rich.tot, "output/prop.rich.tot.csv")
#total sp richness/site
site.sp.table <- read.csv("output/site.sp.mat.csv")
per.site.total<-ddply(site.sp.table, ~X, function(x) {
data.frame(RICHNESS= sum((x[-1]>0)))
})
per.site.total
describe(per.site.total$RICHNESS)
#SLL sp richness/site
SLL.site.sp.matrix<- read.csv("output/SLL.site.sp.mat.csv")
str(SLL.site.sp.matrix)
SLL.per.site.total<-ddply(SLL.site.sp.matrix, ~X, function(x) {
data.frame(RICHNESS_NAT= sum((x[-1]>0)))
})
SLL.per.site.total
describe(SLL.per.site.total$RICHNESS)
#ETF sp richness/site
ETF.site.sp.matrix<- read.csv("output/ETF.site.sp.mat.csv")
str(ETF.site.sp.matrix)
ETF.per.site.total<-ddply(ETF.site.sp.matrix, ~X, function(x) {
data.frame(RICHNESS_NAT= sum((x[-1]>0)))
})
ETF.per.site.total
describe(ETF.per.site.total$RICHNESS)
#SLL.prop
SLL.rich.site.prop <- left_join(per.site.total, SLL.per.site.total)
SLL.rich.site.prop[is.na(SLL.rich.site.prop)] <-0
SLL.rich.site.prop$Proportion <- SLL.rich.site.prop$RICHNESS_NAT/SLL.rich.site.prop$RICHNESS
SLL.rich.site.prop$Region <- "SLL"
str(SLL.rich.site.prop)
SLL.rich.site.prop
#ETF PROP/SITE
ETF.rich.site.prop <- left_join(per.site.total, ETF.per.site.total)
ETF.rich.site.prop[is.na(ETF.rich.site.prop)] <-0
ETF.rich.site.prop$Proportion <- ETF.rich.site.prop$RICHNESS_NAT/ETF.rich.site.prop$RICHNESS
ETF.rich.site.prop$Region <- "ETF"
str(ETF.rich.site.prop)
#JOIN ETF AND SLL
prop.rich.site.tot <- rbind(ETF.rich.site.prop, SLL.rich.site.prop)
View(prop.rich.site.tot)
prop.rich.tot <- prop.rich.site.tot %>%
distinct()
prop.rich.site.tot <- dplyr::rename(prop.rich.site.tot, "Site.Code"=X)
prop.rich.site.tot$Region <- recode(prop.rich.site.tot$Region, "0"="NON-NAT")
View(prop.rich.site.tot)
write.csv(prop.rich.site.tot, "output/prop.rich.site.csv")
#sp richness/park
park.sp.table <- read.csv("output/parks.sp.mat.csv")
str(park.sp.table)
per.park.total<-ddply(park.sp.table,~X, function(x) {
data.frame(RICHNESS= sum((x[-1]>0)))
})
per.park.total
describe(per.park.total$RICHNESS)
#sp richness/street
s.sp.table <- read.csv("output/s.sp.mat.csv")
str(s.sp.table)
per.s.total<-ddply(s.sp.table,~X, function(x) {
data.frame(RICHNESS= sum((x[-1]>0)))
})
per.s.total
describe(per.s.total$RICHNESS)
#sp richness/yard
res.sp.table <- read.csv("output/res.sp.mat.csv")
str(res.sp.table)
per.res.total<-ddply(res.sp.table, ~X, function(x) {
data.frame(RICHNESS= sum((x[-1]>0)))
})
per.res.total
describe(per.res.total$RICHNESS)
#sp richness/institute
ins.sp.table <- read.csv("output/ins.sp.mat.csv")
str(ins.sp.table)
per.ins.total<-ddply(ins.sp.table,~X, function(x) {
data.frame(RICHNESS= sum((x[-1]>0)))
})
per.ins.total
describe(per.ins.total$RICHNESS)
#sp richness/allyeyway
a.sp.table <- read.csv("output/a.sp.mat.csv")
str(a.sp.table)
per.a.total<-ddply(a.sp.table,~X, function(x) {
data.frame(RICHNESS= sum((x[-1]>0)))
})
per.a.total
describe(per.a.total$RICHNESS)
SLL.rich.site.prop <- left_join(per.site.total, SLL.per.site.total)
SLL.rich.site.prop[is.na(SLL.rich.site.prop)] <-0
SLL.rich.site.prop$Proportion <- SLL.rich.site.prop$RICHNESS_NAT/SLL.rich.site.prop$RICHNESS
SLL.rich.site.prop$Region <- "SLL"
str(SLL.rich.site.prop)
SLL.rich.site.prop
#ETF PROP/SITE
ETF.rich.site.prop <- left_join(per.site.total, ETF.per.site.total)
ETF.rich.site.prop[is.na(ETF.rich.site.prop)] <-0
ETF.rich.site.prop$Proportion <- ETF.rich.site.prop$RICHNESS_NAT/ETF.rich.site.prop$RICHNESS
ETF.rich.site.prop$Region <- "ETF"
str(ETF.rich.site.prop)
ETF.rich.site.prop
prop.rich.site.tot <- rbind(ETF.rich.site.prop, SLL.rich.site.prop)
View(prop.rich.site.tot)
prop.rich.tot <- prop.rich.site.tot %>%
distinct()
prop.rich.site.tot <- dplyr::rename(prop.rich.site.tot, "Site.Code"=X)
View(prop.rich.site.tot)
write.csv(prop.rich.site.tot, "output/prop.rich.site.csv")
View(prop.rich.site.tot)
write.csv(prop.rich.site.tot, "output/prop.rich.site.csv")
Site.Rich <- read.csv("output/prop.rich.tot.csv")
str(Site.Rich)
Site.Rich
Site.Rich <- read.csv("output/prop.rich.site.csv")
Site.Rich
Site.Rich <- dplyr::rename(Site.Rich, "Proportion_RICH"= Proportion)
Site.Rich <- dplyr::rename(Site.Rich, "Site.Code"=X)
Site.Rich <- subset(Site.Rich, select = -c(X.1))
Site.Rich <- read.csv("output/prop.rich.site.csv")
Site.Rich
Site.Rich <- dplyr::rename(Site.Rich, "Proportion_RICH"= Proportion)
str(Site.Rich)
Site.Rich <- dplyr::rename(Site.Rich, "Proportion_RICH"= Proportion)
Site.Rich <- read.csv("output/prop.rich.site.csv")
str(Site.Rich)
Site.Rich <- dplyr::rename(Site.Rich, "Proportion_RICH"= Proportion)
Site.Rich <- subset(Site.Rich, select = -c(X))
Site.Rich[order(Site.Rich[,'Site.Code']), ]
Meta.Rich <- dplyr::left_join(Sites, Site.Rich)
ETF.Rich <- subset(Site.Rich, Region=="ETF")
sum(ETF.Rich$RICHNESS_NAT)
Dawson.ETF.Rich <- subset(ETF.Rich, Site.Code=="I1")
Dawson.ETF.Rich
View(Dawson.ETF.Rich)
sum(Dawson.ETF.Rich$RICHNESS_NAT)
SLL.Rich <- subset(Site.Rich, Region=="SLL")
sum(SLL.Rich$RICHNESS_NAT)
Dawson.SLL.Rich <- subset(SLL.Rich, Site.Code=="I1")
sum(Dawson.SLL.Rich$RICHNESS_NAT)
Dawson.ETF.Rich <- subset(ETF.Rich, Site.Code=="I1")
Dawson.ETF.Rich
View(Dawson.ETF.Rich)
sum(Dawson.ETF.Rich$RICHNESS_NAT)
SLL.Rich <- subset(Site.Rich, Region=="SLL")
sum(Dawson.SLL.Rich$RICHNESS_NAT)
Dawson.SLL.Rich
sum(Dawson.SLL.Rich$RICHNESS_NAT)
View(Dawson.SLL.Rich)
Sites.Abund <- read.csv("output/prop.abund.tot.csv")
str(Sites.Abund)
Sites.Abund <- dplyr::rename(Sites.Abund, "Proportion_ABUND"= Proportions)
Sites.Abund <- dplyr::rename(Sites.Abund, "Site.Code"=X)
Sites.Abund <- subset(Sites.Abund, select = -c(X.1))
str(Site.Rich)
Meta.Abund <- dplyr::left_join(Sites, Sites.Abund)
ETF.tot.sp.abund <- left_join(tot.abund.site, ETF.abund.site)
ETF.tot.sp.abund[is.na(ETF.tot.sp.abund)]<-0
ETF.tot.sp.abund$Region
ETF.tot.sp.abund$Proportions <- ETF.tot.sp.abund$ABUNDANCE_NAT/ETF.tot.sp.abund$ABUNDANCE_TOT
Site.Rich <- read.csv("output/prop.rich.site.csv")
str(Site.Rich)
Site.Rich <- dplyr::rename(Site.Rich, "Proportion_RICH"= Proportion)
Site.Rich <- subset(Site.Rich, select = -c(X))
Site.Rich[order(Site.Rich[,'Site.Code']), ]
Meta.Rich <- dplyr::left_join(Sites, Site.Rich)
ETF.Rich <- subset(Site.Rich, Region=="ETF")
sum(ETF.Rich$RICHNESS_NAT)
Dawson.ETF.Rich <- subset(ETF.Rich, Site.Code=="I1")
Dawson.ETF.Rich
View(Dawson.ETF.Rich)
sum(Dawson.ETF.Rich$RICHNESS_NAT)
SLL.Rich <- subset(Site.Rich, Region=="SLL")
sum(SLL.Rich$RICHNESS_NAT)
Dawson.SLL.Rich <- subset(SLL.Rich, Site.Code=="I1")
View(Dawson.SLL.Rich)
sum(Dawson.SLL.Rich$RICHNESS_NAT)
Sites.Abund <- read.csv("output/prop.abund.tot.csv")
str(Sites.Abund)
Sites.Abund <- dplyr::rename(Sites.Abund, "Proportion_ABUND"= Proportions)
Sites.Abund <- dplyr::rename(Sites.Abund, "Site.Code"=X)
Sites.Abund <- subset(Sites.Abund, select = -c(X.1))
str(Site.Rich)
Meta.Abund <- dplyr::left_join(Sites, Sites.Abund)
View(Meta.Abund)
ETF.Abund <- subset(Sites.Abund, Region=="ETF")
str(ETF.Abund)
sum(ETF.Abund$ABUNDANCE_NAT)
Dawson.ETF.Abund <- subset(ETF.Abund, Site.Code=="I1")
sum(Dawson.ETF.Abund$ABUNDANCE_NAT)
SLL.Abund <- subset(Sites.Abund, Region=="SLL")
SLL.Abund
Dawson.SLL.Abund <- subset(SLL.Abund, Site.Code=="I1")
sum(Dawson.SLL.Abund$ABUNDANCE_NAT)
134/261
138/261
Meta.Final <- merge(Meta.Abund, Meta.Rich)
View(Meta.Final)
write.csv(Meta.Final, "output/meta.analysis.csv")
#View(Meta.Rich)
head(Meta.Rich)
#abundance model
aov.abundance <- aov(Proportion_ABUND~Site.Type*Region, data=Meta.Abund)
anova(aov.abundance)
plot(aov.abundance)
head(Meta.Rich)
Meta.Final <- merge(Meta.Abund, Meta.Rich)
View(Meta.Final)
#richness model
glm.richness <- glm(Proportion_RICH~Site.Type*Region*Classification, data=Meta.Rich)
glm.richness
Anova(glm.richness)
#richness model
glm.richness <- glm(Proportion_RICH~Site.Type*Region, data=Meta.Rich)
glm.richness
Anova(glm.richness)
glm.b.richness <- glm(Proportion_RICH~Site.Type+Region, family=binomial, data=Meta.Rich, weights = RICHNESS)
summary(glm.b.richness)
Anova(glm.b.richness)
Meta.Rich$Proportion_RICH==0
sum(Meta.Rich$Proportion_RICH==0)
sum(Meta.Rich$Proportion_RICH==1)
#richness model
glm.richness <- glm(Proportion_RICH~Site.Type*Region, data=Meta.Rich)
glm.richness
Anova(glm.richness)
glm.b.richness <- glm(Proportion_RICH~Site.Type+Region, family=binomial, data=Meta.Rich, weights = RICHNESS)
summary(glm.b.richness)
Anova(glm.b.richness)
print(anova(glm.b.richness))
hist(Meta.Rich$Proportion)
glm.b.richness <- glm(Proportion_RICH~Site.Type+Region, family=binomial(link="logit"), data=Meta.Rich, weights = RICHNESS)
summary(glm.b.richness)
Anova(glm.b.richness)
##Assumptions
plot(glm.b.richness)
vif(glm.b.richness)
car::vif(glm.b.richness)
summary(glm.b.abundance)
Anova(glm.b.abundance)
glm.mod.abund <- lm(Proportion_ABUND~., Meta.Abund, weight=TOTAL_ABUND)
glm.mod.abund <- lm(Proportion_ABUND~., Meta.Abund, weight=ABUNDANCE_TOT)
selected.abund.mod <- step(glm.mod.abund)
selected.abund.mod
summary(selected.abund.mod)
glm.mod.abund <- glm(Proportion_ABUND~., Meta.Abund, weight=ABUNDANCE_TOT)
selected.abund.mod <- step(glm.mod.abund)
selected.abund.mod
glm.mod.abund <- glm(Proportion_ABUND~., binomial, Meta.Abund, weight=ABUNDANCE_TOT)
glm.mod.abund <- glm(Proportion_ABUND~., family="binomial", Meta.Abund, weight=ABUNDANCE_TOT)
selected.abund.mod <- step(glm.mod.abund)
selected.abund.mod
selected.abund.mod <- step(glm.mod.abund)
glm.mod.abund <- glm(Proportion_ABUND~Site.Type*Region, family="binomial", Meta.Abund, weight=ABUNDANCE_TOT)
selected.abund.mod <- step(glm.mod.abund)
glm.mod.abund <- glm(Proportion_ABUND~Site.Type+Region, family="binomial", Meta.Abund, weight=ABUNDANCE_TOT)
selected.abund.mod <- step(glm.mod.abund)
hist(Meta.Abund$Proportion_ABUND)
summary(glm.b.abundance)
glm.b.abundance <- glm(Proportion_ABUND~Site.Type+Region, family=binomial, data=Meta.Abund, weights = ABUNDANCE_TOT)
summary(glm.b.abundance)
